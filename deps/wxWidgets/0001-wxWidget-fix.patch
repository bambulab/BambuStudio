diff --git a/build/cmake/init.cmake b/build/cmake/init.cmake
index 5d88a7e487cc..66e1a4061266 100644
--- a/build/cmake/init.cmake
+++ b/build/cmake/init.cmake
@@ -431,8 +431,17 @@ if(wxUSE_GUI)
                 endforeach()
             endif()
             if(WXGTK3 AND OpenGL_EGL_FOUND AND wxUSE_GLCANVAS_EGL)
-                if(TARGET OpenGL::EGL)
-                    set(OPENGL_LIBRARIES OpenGL::EGL ${OPENGL_LIBRARIES})
+                if(UNIX AND NOT APPLE)
+                    set(OPENGL_LIBRARIES OpenGL EGL)
+                else()
+                    if(TARGET OpenGL::EGL)
+                        set(OPENGL_LIBRARIES OpenGL::EGL ${OPENGL_LIBRARIES})
+                    else()
+                        # It's possible for OpenGL::EGL not to be set even when EGL
+                        # is found, at least under Cygwin (see #23673), so use the
+                        # library directly like this to avoid link problems.
+                        set(OPENGL_LIBRARIES ${OPENGL_egl_LIBRARY} ${OPENGL_LIBRARIES})
+                    endif()
                 endif()
                 set(OPENGL_INCLUDE_DIR ${OPENGL_INCLUDE_DIR} ${OPENGL_EGL_INCLUDE_DIRS})
                 find_package(WAYLANDEGL)
diff --git a/build/cmake/lib/webview/CMakeLists.txt b/build/cmake/lib/webview/CMakeLists.txt
index d8bf88459826..3e06c61ce499 100644
--- a/build/cmake/lib/webview/CMakeLists.txt
+++ b/build/cmake/lib/webview/CMakeLists.txt
@@ -46,9 +46,9 @@ if(APPLE)
 elseif(WXMSW)
     if(wxUSE_WEBVIEW_EDGE)
         # Update the following variables if updating WebView2 SDK
-        set(WEBVIEW2_VERSION "1.0.705.50")
+        set(WEBVIEW2_VERSION "1.0.1418.22")
         set(WEBVIEW2_URL "https://www.nuget.org/api/v2/package/Microsoft.Web.WebView2/${WEBVIEW2_VERSION}")
-        set(WEBVIEW2_SHA256 "6a34bb553e18cfac7297b4031f3eac2558e439f8d16a45945c22945ac404105d")
+        set(WEBVIEW2_SHA256 "51d2ef56196e2a9d768a6843385bcb9c6baf9ed34b2603ddb074fb4995543a99")
 
         set(WEBVIEW2_DEFAULT_PACKAGE_DIR "${CMAKE_CURRENT_BINARY_DIR}/packages/Microsoft.Web.WebView2.${WEBVIEW2_VERSION}")
 
diff --git a/include/wx/fontutil.h b/include/wx/fontutil.h
index 30529db8ce96..c0def3d4411a 100644
--- a/include/wx/fontutil.h
+++ b/include/wx/fontutil.h
@@ -177,7 +177,7 @@ public:
     static double GetCTSlant( CTFontDescriptorRef font );
 
     CTFontDescriptorRef GetCTFontDescriptor() const;
-    
+
     void RealizeResource() const;
 private:
     // attributes for regenerating a CTFontDescriptor, stay close to native values
@@ -294,7 +294,11 @@ public:
     wxFontEncoding GetEncoding() const;
 
     void SetPointSize(int pointsize);
-    void SetFractionalPointSize(double pointsize);
+    void SetFractionalPointSize(double pointsize
+#if defined(__WXMSW__)
+       , const wxWindow *window = nullptr
+#endif
+       );
     void SetPixelSize(const wxSize& pixelSize);
     void SetStyle(wxFontStyle style);
     void SetNumericWeight(int weight);
@@ -307,12 +311,19 @@ public:
 
     // Helper used in many ports: use the normal font size if the input is
     // negative, as we handle -1 as meaning this for compatibility.
-    void SetSizeOrDefault(double size)
+    void SetSizeOrDefault(double size
+#if defined(__WXMSW__)
+       , const wxWindow *window = nullptr
+#endif
+       )
     {
         SetFractionalPointSize
         (
             size < 0 ? wxNORMAL_FONT->GetFractionalPointSize()
                      : size
+#if defined(__WXMSW__)
+            ,window
+#endif
         );
     }
 
diff --git a/include/wx/gdicmn.h b/include/wx/gdicmn.h
index 2f5f8ee99fd1..39e9317d40f8 100644
--- a/include/wx/gdicmn.h
+++ b/include/wx/gdicmn.h
@@ -38,6 +38,7 @@ class WXDLLIMPEXP_FWD_CORE wxRegion;
 class WXDLLIMPEXP_FWD_BASE wxString;
 class WXDLLIMPEXP_FWD_CORE wxIconBundle;
 class WXDLLIMPEXP_FWD_CORE wxPoint;
+class WXDLLIMPEXP_FWD_CORE wxWindow;
 
 // ---------------------------------------------------------------------------
 // constants
@@ -1106,7 +1107,9 @@ extern int WXDLLIMPEXP_CORE wxDisplayDepth();
 
 // get the display size
 extern void WXDLLIMPEXP_CORE wxDisplaySize(int *width, int *height);
+extern void WXDLLIMPEXP_CORE wxDisplaySize(const wxWindow *window, int *width, int *height);
 extern wxSize WXDLLIMPEXP_CORE wxGetDisplaySize();
+extern wxSize WXDLLIMPEXP_CORE wxGetDisplaySize(const wxWindow *window);
 extern void WXDLLIMPEXP_CORE wxDisplaySizeMM(int *width, int *height);
 extern wxSize WXDLLIMPEXP_CORE wxGetDisplaySizeMM();
 extern wxSize WXDLLIMPEXP_CORE wxGetDisplayPPI();
diff --git a/include/wx/generic/grid.h b/include/wx/generic/grid.h
index 1bd58bbf047f..c58e3c2cfd47 100644
--- a/include/wx/generic/grid.h
+++ b/include/wx/generic/grid.h
@@ -3031,7 +3031,8 @@ private:
     // actually in progress.
     void DoGridDragResize(const wxPoint& position,
                           const wxGridOperations& oper,
-                          wxGridWindow* gridWindow);
+                          wxGridWindow* gridWindow,
+                          CursorMode mode);
 
     // process different clicks on grid cells
     void DoGridCellLeftDown(wxMouseEvent& event,
diff --git a/include/wx/msw/font.h b/include/wx/msw/font.h
index 0f9768b44e37..094d7749186e 100644
--- a/include/wx/msw/font.h
+++ b/include/wx/msw/font.h
@@ -23,7 +23,7 @@ public:
     // ctors and such
     wxFont() { }
 
-    wxFont(const wxFontInfo& info);
+    wxFont(const wxFontInfo& info, const wxWindow *window = nullptr);
 
     wxFont(int size,
            wxFontFamily family,
diff --git a/include/wx/msw/tooltip.h b/include/wx/msw/tooltip.h
index 4c3be08cecac..fb9212ec1317 100644
--- a/include/wx/msw/tooltip.h
+++ b/include/wx/msw/tooltip.h
@@ -92,9 +92,11 @@ private:
     // but use GetToolTipCtrl() which will create it when needed
     static WXHWND ms_hwndTT;
 
+public:
     // create the tooltip ctrl if it doesn't exist yet and return its HWND
     static WXHWND GetToolTipCtrl();
 
+private:
     // to be used in wxModule for deleting tooltip ctrl window when exiting mainloop
     static void DeleteToolTipCtrl();
 
diff --git a/include/wx/osx/app.h b/include/wx/osx/app.h
index 317a0ca96f41..58014ec1d440 100644
--- a/include/wx/osx/app.h
+++ b/include/wx/osx/app.h
@@ -161,7 +161,7 @@ private:
 
 public:
     bool                OSXInitWasCalled() { return m_inited; }
-    void                OSXStoreOpenFiles(const wxArrayString &files ) { m_openFiles = files ; }
+    virtual void        OSXStoreOpenFiles(const wxArrayString &files ) { m_openFiles = files ; }
     void                OSXStorePrintFiles(const wxArrayString &files ) { m_printFiles = files ; }
     void                OSXStoreOpenURL(const wxString &url ) { m_getURL = url ; }
 #endif
diff --git a/src/common/combocmn.cpp b/src/common/combocmn.cpp
index 8f443bc1804a..dda2c2092b7c 100644
--- a/src/common/combocmn.cpp
+++ b/src/common/combocmn.cpp
@@ -1952,7 +1952,7 @@ void wxComboCtrlBase::CreatePopup()
 
     if ( !m_winPopup )
     {
-        m_winPopup = new wxComboPopupWindow( this, wxNO_BORDER );
+        m_winPopup = new wxComboPopupWindow( this, wxNO_BORDER | wxSTAY_ON_TOP );
 
         m_winPopup->Bind(wxEVT_KEY_DOWN, &wxComboCtrlBase::OnPopupKey, this);
         m_winPopup->Bind(wxEVT_CHAR, &wxComboCtrlBase::OnPopupKey, this);
@@ -2102,6 +2102,9 @@ void wxComboCtrlBase::ShowPopup()
 
     SetFocus();
 
+    //int displayIdx = wxDisplay::GetFromWindow(this);
+    //wxRect displayRect = wxDisplay(displayIdx != wxNOT_FOUND ? displayIdx : 0u).GetGeometry();
+
     // Space above and below
     int screenHeight;
     wxPoint scrPos;
@@ -2224,9 +2227,13 @@ void wxComboCtrlBase::ShowPopup()
 
     int showFlags = CanDeferShow;
 
-    if ( spaceBelow < szp.y )
+    int anchorSideVertical = m_anchorSide & (wxUP | wxDOWN);
+    if (// Pop up as asked for by the library user.
+        (anchorSideVertical & wxUP) ||
+        // Automatic: Pop up if it does not fit down.
+        (anchorSideVertical == 0 && spaceBelow < szp.y ))
     {
-        popupY = scrPos.y - szp.y;
+        popupY = scrPos.y - szp.y + displayRect.GetTop();
         showFlags |= ShowAbove;
     }
 
diff --git a/src/common/datavcmn.cpp b/src/common/datavcmn.cpp
index 244833b161ab..a2e213ed5d3d 100644
--- a/src/common/datavcmn.cpp
+++ b/src/common/datavcmn.cpp
@@ -1335,7 +1335,11 @@ wxDataViewItem wxDataViewCtrlBase::GetSelection() const
 
     wxDataViewItemArray selections;
     GetSelections(selections);
-    return selections[0];
+    // BBS
+    if (!selections.empty())
+        return selections[0];
+    else
+        return wxDataViewItem(0);
 }
 
 namespace
diff --git a/src/common/dcbufcmn.cpp b/src/common/dcbufcmn.cpp
index 9b1c1f3159b6..e46d1b97f52c 100644
--- a/src/common/dcbufcmn.cpp
+++ b/src/common/dcbufcmn.cpp
@@ -83,9 +83,15 @@ private:
         const double scale = dc ? dc->GetContentScaleFactor() : 1.0;
         wxBitmap* const buffer = new wxBitmap;
 
+#if __WXMSW__
         // we must always return a valid bitmap but creating a bitmap of
         // size 0 would fail, so create a 1*1 bitmap in this case
-        buffer->CreateWithDIPSize(wxMax(w, 1), wxMax(h, 1), scale);
+        buffer->Create(wxMax(w, 1), wxMax(h, 1), 24);
+#else
+        // we must always return a valid bitmap but creating a bitmap of
+        // size 0 would fail, so create a 1*1 bitmap in this case
+        buffer->CreateScaled(wxMax(w, 1), wxMax(h, 1), -1, scale);
+#endif
 
         return buffer;
     }
diff --git a/src/common/gdicmn.cpp b/src/common/gdicmn.cpp
index db8a01f961e2..a1bf3f09613f 100644
--- a/src/common/gdicmn.cpp
+++ b/src/common/gdicmn.cpp
@@ -863,11 +863,25 @@ void wxDisplaySize(int *width, int *height)
         *height = size.y;
 }
 
+void wxDisplaySize(const wxWindow *window, int *width, int *height)
+{
+    const wxSize size = wxGetDisplaySize(window);
+    if ( width )
+        *width = size.x;
+    if ( height )
+        *height = size.y;
+}
+
 wxSize wxGetDisplaySize()
 {
     return wxDisplay().GetGeometry().GetSize();
 }
 
+wxSize wxGetDisplaySize(const wxWindow *window)
+{
+    return window ? wxDisplay(window).GetGeometry().GetSize() : wxDisplay().GetGeometry().GetSize();
+}
+
 void wxClientDisplayRect(int *x, int *y, int *width, int *height)
 {
     const wxRect rect = wxGetClientDisplayRect();
diff --git a/src/generic/grid.cpp b/src/generic/grid.cpp
index 6de9d9f81480..da2b552da390 100644
--- a/src/generic/grid.cpp
+++ b/src/generic/grid.cpp
@@ -4073,7 +4073,8 @@ void wxGrid::ProcessRowColLabelMouseEvent( const wxGridOperations &oper, wxMouse
         {
             if ( m_cursorMode == oper.GetCursorModeResize() )
             {
-                DoGridDragResize(event.GetPosition(), oper, gridWindow);
+                //BBS: add cursor mode for DoGridDragResize's paremeters
+                DoGridDragResize(event.GetPosition(), wxGridRowOperations(), gridWindow, WXGRID_CURSOR_RESIZE_ROW);
             }
             else if ( m_cursorMode == oper.GetCursorModeSelect() && line >=0 )
             {
@@ -4696,12 +4697,18 @@ bool wxGrid::DoGridDragEvent(wxMouseEvent& event,
 
         case WXGRID_CURSOR_RESIZE_ROW:
             if ( m_dragRowOrCol != -1 )
-                DoGridDragResize(event.GetPosition(), wxGridRowOperations(), gridWindow);
+            {
+                //BBS: add cursor mode for DoGridDragResize's paremeters
+                DoGridDragResize(event.GetPosition(), wxGridRowOperations(), gridWindow, WXGRID_CURSOR_RESIZE_ROW);
+            }
             break;
 
         case WXGRID_CURSOR_RESIZE_COL:
             if ( m_dragRowOrCol != -1 )
-                DoGridDragResize(event.GetPosition(), wxGridColumnOperations(), gridWindow);
+            {
+                //BBS: add cursor mode for DoGridDragResize's paremeters
+                DoGridDragResize(event.GetPosition(), wxGridColumnOperations(), gridWindow, WXGRID_CURSOR_RESIZE_COL);
+            }
             break;
 
         default:
@@ -4796,6 +4803,8 @@ wxGrid::DoGridCellLeftDown(wxMouseEvent& event,
                             case wxGridSelectCells:
                             case wxGridSelectRowsOrColumns:
                                 // nothing to do in these cases
+                                // BBS: select this cell when first click
+                                m_selection->SelectBlock(coords.GetRow(), coords.GetCol(), coords.GetRow(), coords.GetCol(), event);
                                 break;
 
                             case wxGridSelectRows:
@@ -5054,9 +5063,11 @@ void wxGrid::ProcessGridCellMouseEvent(wxMouseEvent& event, wxGridWindow *eventG
     }
 }
 
+//BBS: add cursor mode for DoGridDragResize's paremeters
 void wxGrid::DoGridDragResize(const wxPoint& position,
                               const wxGridOperations& oper,
-                              wxGridWindow* gridWindow)
+                              wxGridWindow* gridWindow,
+                              CursorMode mode)
 {
     wxCHECK_RET( m_dragRowOrCol != -1,
                  "shouldn't be called when not drag resizing" );
@@ -5069,10 +5080,28 @@ void wxGrid::DoGridDragResize(const wxPoint& position,
     // orthogonal direction.
     const int linePos = oper.Dual().Select(logicalPos);
 
-    const int lineStart = oper.GetLineStartPos(this, m_dragRowOrCol);
-    oper.SetLineSize(this, m_dragRowOrCol,
+    //BBS: add logic for resize multiplexed cols
+    if (mode == WXGRID_CURSOR_RESIZE_COL) {
+        int col_to_resize = m_dragRowOrCol;
+        int num_rows, num_cols;
+        this->GetCellSize(0, m_dragRowOrCol, &num_rows, &num_cols);
+        if (num_cols < 1)
+            col_to_resize = m_dragRowOrCol - 1;
+
+        const int lineEnd = oper.GetLineEndPos(this, m_dragRowOrCol);
+        const int lineSize = oper.GetLineSize(this, col_to_resize);
+        int size = linePos - lineEnd + lineSize;
+        oper.SetLineSize(this, col_to_resize,
+                     wxMax(size,
+                           oper.GetMinimalLineSize(this, col_to_resize)));
+    }
+    else {
+        const int lineStart = oper.GetLineStartPos(this, m_dragRowOrCol);
+
+        oper.SetLineSize(this, m_dragRowOrCol,
                      wxMax(linePos - lineStart,
                            oper.GetMinimalLineSize(this, m_dragRowOrCol)));
+    }
 
     // TODO: generate RESIZING event, see #10754, if the size has changed.
 }
@@ -5095,7 +5124,8 @@ wxPoint wxGrid::GetPositionForResizeEvent(int width) const
 
 void wxGrid::DoEndDragResizeRow(const wxMouseEvent& event, wxGridWindow* gridWindow)
 {
-    DoGridDragResize(event.GetPosition(), wxGridRowOperations(), gridWindow);
+    //BBS: add cursor mode for DoGridDragResize's paremeters
+    DoGridDragResize(event.GetPosition(), wxGridRowOperations(), gridWindow, WXGRID_CURSOR_RESIZE_ROW);
 
     SendGridSizeEvent(wxEVT_GRID_ROW_SIZE, m_dragRowOrCol, event);
 
@@ -5104,7 +5134,8 @@ void wxGrid::DoEndDragResizeRow(const wxMouseEvent& event, wxGridWindow* gridWin
 
 void wxGrid::DoEndDragResizeCol(const wxMouseEvent& event, wxGridWindow* gridWindow)
 {
-    DoGridDragResize(event.GetPosition(), wxGridColumnOperations(), gridWindow);
+    //BBS: add cursor mode for DoGridDragResize's paremeters
+    DoGridDragResize(event.GetPosition(), wxGridColumnOperations(), gridWindow, WXGRID_CURSOR_RESIZE_COL);
 
     SendGridSizeEvent(wxEVT_GRID_COL_SIZE, m_dragRowOrCol, event);
 
@@ -5118,9 +5149,10 @@ void wxGrid::DoHeaderStartDragResizeCol(int col)
 
 void wxGrid::DoHeaderDragResizeCol(int width)
 {
+    //BBS: add cursor mode for DoGridDragResize's paremeters
     DoGridDragResize(GetPositionForResizeEvent(width),
                      wxGridColumnOperations(),
-                     m_gridWin);
+                     m_gridWin, WXGRID_CURSOR_RESIZE_COL);
 }
 
 void wxGrid::DoHeaderEndDragResizeCol(int width)
@@ -6017,7 +6049,10 @@ void wxGrid::OnKeyDown( wxKeyEvent& event )
                     // cells in the last row or when using Shift-Enter).
                     DisableCellEditControl();
 
-                    MoveCursorDown( event.ShiftDown() );
+                    //BBS: select this cell when first click
+                    m_selection->SelectBlock(m_currentCellCoords.GetRow(), m_currentCellCoords.GetCol(),
+                                             m_currentCellCoords.GetRow(), m_currentCellCoords.GetCol(),
+                                             event);
                 }
                 break;
 
diff --git a/src/msw/font.cpp b/src/msw/font.cpp
index 434876939c5f..91d460301891 100644
--- a/src/msw/font.cpp
+++ b/src/msw/font.cpp
@@ -54,7 +54,7 @@ static const int PITCH_MASK = FIXED_PITCH | VARIABLE_PITCH;
 class WXDLLEXPORT wxFontRefData: public wxGDIRefData
 {
 public:
-    wxFontRefData(const wxFontInfo& info = wxFontInfo());
+    wxFontRefData(const wxFontInfo& info = wxFontInfo(), const wxWindow* window = nullptr);
 
     wxFontRefData(const wxNativeFontInfo& info, WXHFONT hFont = 0)
     {
@@ -324,7 +324,7 @@ protected:
 // wxFontRefData
 // ----------------------------------------------------------------------------
 
-wxFontRefData::wxFontRefData(const wxFontInfo& info)
+wxFontRefData::wxFontRefData(const wxFontInfo& info, const wxWindow *window)
 {
     m_hFont = NULL;
 
@@ -335,7 +335,7 @@ wxFontRefData::wxFontRefData(const wxFontInfo& info)
     }
     else
     {
-        m_nativeFontInfo.SetSizeOrDefault(info.GetFractionalPointSize());
+        m_nativeFontInfo.SetSizeOrDefault(info.GetFractionalPointSize(), window);
     }
 
     SetStyle(info.GetStyle());
@@ -518,12 +518,12 @@ wxFontEncoding wxNativeFontInfo::GetEncoding() const
     return wxGetFontEncFromCharSet(lf.lfCharSet);
 }
 
-void wxNativeFontInfo::SetFractionalPointSize(double pointSizeNew)
+void wxNativeFontInfo::SetFractionalPointSize(double pointSizeNew, const wxWindow *window)
 {
     // We don't have the correct DPI to use here, so use that of the
     // primary screen and rely on WXAdjustToPPI() changing it later if
     // necessary.
-    const int ppi = ::GetDeviceCaps(ScreenHDC(), LOGPIXELSY);
+    const int ppi = window ? window->GetDPI().GetY() : ::GetDeviceCaps(ScreenHDC(), LOGPIXELSY);
     lf.lfHeight = GetLogFontHeightAtPPI(pointSizeNew, ppi);
 
     pointSize = pointSizeNew;
@@ -812,9 +812,9 @@ wxFont::wxFont(const wxString& fontdesc)
         (void)Create(info);
 }
 
-wxFont::wxFont(const wxFontInfo& info)
+wxFont::wxFont(const wxFontInfo& info, const wxWindow *window)
 {
-    m_refData = new wxFontRefData(info);
+    m_refData = new wxFontRefData(info, window);
 }
 
 bool wxFont::Create(const wxNativeFontInfo& info, WXHFONT hFont)
diff --git a/src/msw/menuitem.cpp b/src/msw/menuitem.cpp
index c60d38550d5d..0486bc38ec18 100644
--- a/src/msw/menuitem.cpp
+++ b/src/msw/menuitem.cpp
@@ -369,6 +369,8 @@ void MenuDrawData::Init(wxWindow const* window)
         // native menu uses small top margin for separator
         if ( SeparatorMargin.cyTopHeight >= 2 )
             SeparatorMargin.cyTopHeight -= 2;
+
+        SeparatorSize.cy = 0;
     }
     else
 #endif // wxUSE_UXTHEME
diff --git a/src/msw/window.cpp b/src/msw/window.cpp
index 44530f7f990b..88217f660bc4 100644
--- a/src/msw/window.cpp
+++ b/src/msw/window.cpp
@@ -4809,29 +4809,45 @@ static wxSize GetWindowDPI(HWND hwnd)
 }
 
 /*extern*/
-int wxGetSystemMetrics(int nIndex, const wxWindow* window)
+int wxGetSystemMetrics(int nIndex, const wxWindow* win)
 {
 #if wxUSE_DYNLIB_CLASS
-    if ( !window )
-        window = wxApp::GetMainTopWindow();
+    const wxWindow* window = (!win && wxTheApp) ? wxTheApp->GetTopWindow() : win;
 
-    if ( window )
+    if (window)
     {
-        typedef int (WINAPI * GetSystemMetricsForDpi_t)(int nIndex, UINT dpi);
-        static GetSystemMetricsForDpi_t s_pfnGetSystemMetricsForDpi = NULL;
-        static bool s_initDone = false;
-
-        if ( !s_initDone )
-        {
-            wxLoadedDLL dllUser32("user32.dll");
-            wxDL_INIT_FUNC(s_pfn, GetSystemMetricsForDpi, dllUser32);
-            s_initDone = true;
+#if 1
+        if (window->GetHWND() && (nIndex == SM_CXSCREEN || nIndex == SM_CYSCREEN)) {
+            HDC hdc = GetDC(window->GetHWND());
+#if 0
+            double dim = GetDeviceCaps(hdc, nIndex == SM_CXSCREEN ? HORZRES : VERTRES);
+            ReleaseDC(window->GetHWND(), hdc);
+            wxSize dpi = window->GetDPI();
+            dim *= 96.0 / (nIndex == SM_CXSCREEN ? dpi.x : dpi.y);
+            return int(dim + 0.5);
+#else
+            return int(GetDeviceCaps(hdc, nIndex == SM_CXSCREEN ? HORZRES : VERTRES));
+#endif
         }
-
-        if ( s_pfnGetSystemMetricsForDpi )
+        else
+#endif
         {
-            const int dpi = window->GetDPI().y;
-            return s_pfnGetSystemMetricsForDpi(nIndex, (UINT)dpi);
+            typedef int (WINAPI * GetSystemMetricsForDpi_t)(int nIndex, UINT dpi);
+            static GetSystemMetricsForDpi_t s_pfnGetSystemMetricsForDpi = NULL;
+            static bool s_initDone = false;
+
+            if ( !s_initDone )
+            {
+                wxLoadedDLL dllUser32("user32.dll");
+                wxDL_INIT_FUNC(s_pfn, GetSystemMetricsForDpi, dllUser32);
+                s_initDone = true;
+            }
+
+            if ( s_pfnGetSystemMetricsForDpi )
+            {
+                const int dpi = window->GetDPI().y;
+                return s_pfnGetSystemMetricsForDpi(nIndex, (UINT)dpi);
+            }
         }
     }
 #else
diff --git a/src/osx/cocoa/dataview.mm b/src/osx/cocoa/dataview.mm
index 82d1fbb9ca20..f3d6b80c54a3 100644
--- a/src/osx/cocoa/dataview.mm
+++ b/src/osx/cocoa/dataview.mm
@@ -1650,6 +1650,16 @@ outlineView:(NSOutlineView*)outlineView
     }
 }
 
+//FIXME Vojtech: This is a workaround to get at least the "mouse move" events at the wxDataViewControl,
+// so we can show the tooltips. The "mouse move" events are being send only if the wxDataViewControl
+// has focus, which is a limitation of wxWidgets. We may grab focus on "mouse entry" though.
+- (void)mouseMoved:(NSEvent *)event
+{
+if (! implementation->DoHandleMouseEvent(event))
+        [super mouseMoved:event];
+}
+
+
 //
 // contextual menus
 //
@@ -2057,7 +2067,8 @@ void wxCocoaDataViewControl::keyEvent(WX_NSEvent event, WXWidget slf, void *_cmd
         if ( !dvc->GetEventHandler()->ProcessEvent(eventDV) )
             wxWidgetCocoaImpl::keyEvent(event, slf, _cmd);
     }
-    else
+    //FIXME Vojtech's hack to get the accelerators assigned to the wxDataViewControl working.
+    else if (! implementation->DoHandleKeyEvent(event))
     {
         wxWidgetCocoaImpl::keyEvent(event, slf, _cmd);  // all other keys
     }
@@ -2612,7 +2623,18 @@ void wxCocoaDataViewControl::HitTest(const wxPoint& point_, wxDataViewItem& item
     point.x += visibleRect.origin.x;
     point.y += visibleRect.origin.y;
 
-    NSPoint const nativePoint = wxToNSPoint((NSScrollView*) GetWXWidget(),point);
+    NSTableHeaderView *headerView = [m_OutlineView headerView];
+    if (headerView && point.y < headerView.visibleRect.size.height) {
+    // The point is inside the header area.
+            columnPtr = NULL;
+            item      = wxDataViewItem();
+    return;
+        }
+    // Convert from the window coordinates to the virtual scrolled view coordinates.
+    NSScrollView *scrollView = [m_OutlineView enclosingScrollView];
+    const NSRect &visibleRect = scrollView.contentView.visibleRect;
+    NSPoint const nativePoint = wxToNSPoint((NSScrollView*) GetWXWidget(),
+    wxPoint(point.x + visibleRect.origin.x, point.y + visibleRect.origin.y));
 
     int indexColumn;
     int indexRow;
diff --git a/src/osx/cocoa/settings.mm b/src/osx/cocoa/settings.mm
index c819deeb0c29..852f4104e411 100644
--- a/src/osx/cocoa/settings.mm
+++ b/src/osx/cocoa/settings.mm
@@ -87,7 +87,7 @@ bool wxSystemAppearance::IsDark() const
 wxColour wxSystemSettingsNative::GetColour(wxSystemColour index)
 {
     wxOSXEffectiveAppearanceSetter helper;
-    
+
     NSColor* sysColor = nil;
     switch( index )
     {
@@ -222,7 +222,7 @@ wxFont wxSystemSettingsNative::GetFont(wxSystemFont index)
 // ----------------------------------------------------------------------------
 
 // Get a system metric, e.g. scrollbar size
-int wxSystemSettingsNative::GetMetric(wxSystemMetric index, const wxWindow* WXUNUSED(win))
+int wxSystemSettingsNative::GetMetric(wxSystemMetric index, const wxWindow* win)
 {
     int value;
 
@@ -257,11 +257,11 @@ int wxSystemSettingsNative::GetMetric(wxSystemMetric index, const wxWindow* WXUN
         // TODO case wxSYS_WINDOWMIN_Y:
 
         case wxSYS_SCREEN_X:
-            wxDisplaySize(&value, NULL);
+            wxDisplaySize(win, &value, nullptr);
             return value;
 
         case wxSYS_SCREEN_Y:
-            wxDisplaySize(NULL, &value);
+            wxDisplaySize(win, nullptr, &value);
             return value;
 
         // TODO case wxSYS_FRAMESIZE_X:
